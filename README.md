# Генератор прописей по методике В. Илюхиной

Веб-приложение для генерации прописей для обучения письму по методике В. Илюхиной.

## Функциональность

- Ввод задания (до 80 символов)
- Выбор варианта заполнения (три опции)
- Ввод текста прописи
- Настройка разметки страницы (клетка или линейка)
- Выбор вида линий (пунктир, серый, черный)
- Выбор ориентации страницы (книжная или альбомная)
- Добавление подписи на каждой странице
- Генерация PDF для скачивания и печати

## Шрифты

В приложении используются шрифты прописей:
- `ilyukhina.ttf` — основной шрифт, созданный по методике В. Илюхиной
- `propisi.ttf` — альтернативный шрифт прописей

Шрифты находятся в директории `backend/fonts/` и автоматически подключаются при генерации PDF.

## Структура проекта

- `/frontend` - React фронтенд
- `/backend` - Python FastAPI бэкенд для генерации PDF
  - `/backend/fonts` - Шрифты для прописей

## Быстрый запуск

### Windows

```
start.bat
```

Для запуска в режиме разработки (фронтенд и бэкенд в отдельных окнах):
```
start.bat dev
```

Для запуска через Docker:
```
start.bat docker
```

### Linux/Mac

```
chmod +x start.sh
./start.sh
```

Для запуска в режиме разработки (фронтенд и бэкенд в отдельных окнах):
```
chmod +x start.sh
./start.sh dev
```

Для запуска через Docker:
```
chmod +x start.sh
./start.sh docker
```

## Установка и запуск вручную

### Бэкенд

1. Перейдите в папку `/backend`
2. Создайте виртуальное окружение Python:
   ```
   python -m venv venv
   ```
3. Активируйте виртуальное окружение:
   - Windows: `venv\Scripts\activate`
   - Linux/Mac: `source venv/bin/activate`
4. Установите зависимости с помощью специального скрипта:
   - Windows: `install_dependencies.bat`
   - Linux/Mac: `chmod +x install_dependencies.sh && ./install_dependencies.sh`
5. Запустите сервер:
   ```
   python run.py
   ```
   
Сервер будет доступен по адресу: `http://localhost:8000`

### Фронтенд

1. Перейдите в папку `/frontend`
2. Установите зависимости:
   ```
   npm install
   ```
3. Запустите сервер разработки:
   ```
   npm start
   ```

Приложение будет доступно по адресу: `http://localhost:3000`

### Одновременный запуск

Для одновременного запуска фронтенда и бэкенда:

```
npm install
npm start
```

## Развертывание на Vercel

Проект готов к развертыванию на Vercel. Для этого выполните следующие шаги:

1. Создайте аккаунт на Vercel и установите Vercel CLI:
   ```
   npm install -g vercel
   ```

2. Войдите в свой аккаунт:
   ```
   vercel login
   ```

3. Разверните проект:
   ```
   vercel
   ```

Важные замечания:
- Убедитесь, что в корне проекта есть корректный файл `vercel.json`
- В настройках проекта на Vercel.com установите переменную окружения `VERCEL=true`
- Для корректной работы фронтенда с API, в настройках проекта укажите `REACT_APP_API_URL` с URL вашего деплоя

### Деплой фронтенда и бэкенда отдельно

Для более гибкой настройки можно разместить фронтенд и бэкенд отдельно:

1. Разверните бэкенд:
   ```
   cd backend
   vercel
   ```

2. Запишите URL бэкенда, созданный Vercel

3. Разверните фронтенд с указанием URL бэкенда:
   ```
   cd frontend
   vercel -e REACT_APP_API_URL=https://url-вашего-бэкенда
   ```

## Развертывание с использованием Docker

Проект можно развернуть с использованием Docker:

```
docker build -t propisi-generator .
docker run -p 8000:8000 propisi-generator
```

Или с использованием docker-compose:

```
docker-compose up
```

Приложение будет доступно по адресу: `http://localhost:8000`

## API

### Генерация PDF

#### Запрос

```
POST /api/generate-pdf
Content-Type: multipart/form-data
```

| Параметр | Тип | Описание |
|----------|-----|----------|
| task | string | Задание (до 80 символов) |
| fill_type | string | Вариант заполнения: "all", "first_letter", "one_line" |
| text | string | Текст прописи |
| page_layout | string | Разметка страницы: "cells", "lines", "lines_oblique" |
| font_type | string | Вид линий: "punktir", "gray", "black" |
| page_orientation | string | Ориентация страницы: "portrait", "landscape" |
| student_name | string | Имя ученика (необязательно) |

#### Ответ

```
Content-Type: application/pdf
```

PDF файл с прописями, который можно скачать и распечатать.

## Требования

- Python 3.10+
- Node.js 16+
- npm 8+

### Решение проблем

#### Ошибки с Pillow (PIL)
Если вы видите ошибки, связанные с установкой Pillow, воспользуйтесь скриптами:
- Windows: `backend\install_dependencies.bat`
- Linux/Mac: `backend/install_dependencies.sh`

Эти скрипты устанавливают Pillow из предкомпилированных бинарных пакетов, что решает большинство проблем с компиляцией.

Если проблемы остаются, попробуйте установить системные зависимости:

**Windows:**
```
vcpkg install libjpeg-turbo:x64-windows zlib:x64-windows
```

**Linux:**
```
sudo apt-get install python3-dev libjpeg-dev zlib1g-dev
```

**Mac:**
```
brew install libjpeg
```

## Дополнительная информация

Для полной функциональности необходимо добавить шрифт для методики В. Илюхиной. При необходимости, приобретите соответствующую лицензию или используйте open-source альтернативу. 